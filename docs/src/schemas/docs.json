{"openapi":"3.0.0","info":{"version":"1.0.0","title":"MyBus Explorer API"},"components":{"schemas":{},"parameters":{}},"paths":{"/":{"get":{"tags":["App"],"description":"Root of the app","summary":"Hello message from app","responses":{"200":{"description":"Hello message from app","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/health":{"get":{"tags":["App"],"description":"Check app health","summary":"App health status","responses":{"200":{"description":"Health check","content":{"text/plain":{"schema":{"type":"string"}}}}}}},"/transit-points":{"get":{"tags":["Transit Points"],"summary":"Get route transit points","description":"Returns the ordered list of stops and intermediate points for a given route number and variant.","parameters":[{"schema":{"type":"string","example":"160"},"required":true,"name":"routeNumber","in":"query"},{"schema":{"type":"string","example":"B"},"required":true,"name":"routeVariant","in":"query"}],"responses":{"200":{"description":"List of route transit points","content":{"application/json":{"schema":{"type":"object","properties":{"route":{"type":"object","properties":{"number":{"type":"string","example":"550"},"variant":{"type":"string","example":"A"}},"required":["number","variant"]},"points":{"type":"array","items":{"anyOf":[{"type":"object","properties":{"type":{"type":"string","enum":["stop"]},"id":{"type":"number","example":12345}},"required":["type","id"]},{"type":"object","properties":{"type":{"type":"string","enum":["point"]},"position":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]}},"required":["type","position"]}]}}},"required":["route","points"]}}}},"400":{"description":"Invalid parameters"},"500":{"description":"Internal server error"}}}},"/vehicle":{"get":{"tags":["Vehicles"],"summary":"Get online vehicles","description":"Returns a list of currently online vehicles, optionally filtered by route number.","parameters":[{"schema":{"type":"string","example":"160","description":"Optional route number to filter vehicles"},"required":false,"description":"Optional route number to filter vehicles","name":"route","in":"query"}],"responses":{"200":{"description":"List of vehicles currently operating","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"12345"},"sideNumer":{"type":"string","example":"30883"},"position":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]},"_positionP":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]},"status":{"type":"object","properties":{"id":{"type":"number","example":1},"flags":{"type":"object","properties":{"moving":{"type":"boolean"},"enRoute":{"type":"boolean"}},"required":["moving","enRoute"]}},"required":["id"]},"currentRoute":{"type":"object","properties":{"number":{"type":"string","example":"160"},"destination":{"type":"string","example":"Choiny"},"variant":{"type":"string","example":"B"},"direction":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"outbound"}},"required":["id","type"]},"id":{"type":"string","example":"160"}},"required":["number","destination","variant","direction","id"]},"nextRoute":{"type":"object","properties":{"number":{"type":"string","example":"160"},"destination":{"type":"string","example":"Choiny"},"variant":{"type":"string","example":"B"},"direction":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"outbound"}},"required":["id","type"]},"id":{"type":"string","example":"160"}},"required":["number","destination","variant","direction","id"]},"delay":{"type":"number","example":45},"flags":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"E"},"feature":{"type":"string","example":"electric"}},"required":["id","feature"]}},"type":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"tram"}},"required":["id","type"]},"nextStopOnRouteIndex":{"type":"number","example":3},"brigade":{"type":"string","example":"160/03"},"plannedDepartureTime":{"type":"string","example":"14:17"}},"required":["id","sideNumer","position","_positionP","status","currentRoute","nextRoute","delay","flags","type","nextStopOnRouteIndex","brigade","plannedDepartureTime"]}}}}},"400":{"description":"Invalid parameters"},"500":{"description":"Internal server error"}}}},"/schedule/database/database":{"get":{"tags":["Schedule"],"summary":"Get schedule database stream","description":"Returns a decompressed schedule database as a binary stream. The stream is generated from a gzip-compressed schedule source.","responses":{"200":{"description":"Decompressed binary schedule data","content":{"application/octet-stream":{"schema":{"type":"string","format":"binary"}}}},"500":{"description":"Failed to decompress or fetch schedule data"}}}},"/schedule/check/schedule/check":{"get":{"tags":["Schedule"],"summary":"Check if schedule has changed","description":"Compares schedule version and generation values to determine if the schedule data has changed.","parameters":[{"schema":{"type":"string","example":"1024","description":"Schedule version number"},"required":true,"description":"Schedule version number","name":"version","in":"query"},{"schema":{"type":"string","example":"5","description":"Schedule generation number"},"required":true,"description":"Schedule generation number","name":"generation","in":"query"}],"responses":{"200":{"description":"Boolean flag indicating if the schedule changed","content":{"application/json":{"schema":{"type":"object","properties":{"changed":{"type":"boolean","example":true}},"required":["changed"]}}}},"400":{"description":"Invalid parameters"},"500":{"description":"Internal server error"}}}},"/timetable/vehicle":{"get":{"tags":["Timetable"],"summary":"Get timetable for a vehicle","description":"Returns the timetable information for a specific vehicle identified by sideNumber.","parameters":[{"schema":{"type":"string","example":"30883"},"required":true,"name":"sideNumber","in":"query"}],"responses":{"200":{"description":"Vehicle timetable","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"number","example":330},"route":{"type":"object","properties":{"number":{"type":"string","example":"160"},"variant":{"type":"string","example":"B"},"destination":{"type":"string","example":"Choiny"}},"required":["number","variant","destination"]},"stops":{"type":"array","items":{"type":"object","properties":{"stop":{"type":"object","properties":{"numberEnRoute":{"type":"number","example":3},"idSip":{"type":"number","example":330},"name":{"type":"string","example":"WYŚCIGOWA 02"}},"required":["numberEnRoute","idSip","name"]},"time":{"type":"object","properties":{"label":{"type":"string","example":"09:30"},"seconds":{"type":"number","example":34200}},"required":["label","seconds"]},"status":{"type":"object","properties":{"id":{"type":"number","example":1},"status":{"type":"string","example":"WITHIN_STOP_AREA"}},"required":["id","status"]}},"required":["stop","time","status"]}}},"required":["id","route","stops"]}}}},"400":{"description":"Invalid parameters"},"500":{"description":"Internal server error"}}}},"/timetable/stop":{"get":{"tags":["Timetable"],"summary":"Get timetable for a stop","description":"Returns timetable information for a specific stop identified by stop ID.","parameters":[{"schema":{"type":"string","example":"330","description":"Stop Sip Id"},"required":true,"description":"Stop Sip Id","name":"stop","in":"query"}],"responses":{"200":{"description":"Stop timetable","content":{"application/json":{"schema":{"type":"object","properties":{"stopIdSip":{"type":"number","example":330},"currentTime":{"type":"string","example":"2025-10-16T09:25:00Z"},"departures":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"330"},"estimatedDeparture":{"type":"object","properties":{"time":{"type":"string","example":"2025-10-16T09:25:00Z"},"seconds":{"type":"number","example":34200},"label":{"type":"string","example":"09:30"}},"required":["time","seconds","label"]},"trackingStatus":{"type":"object","properties":{"id":{"type":"number","example":1},"status":{"type":"string","example":"WITHIN_STOP_AREA"}},"required":["id","status"]},"destination":{"type":"string","example":"Choiny"},"route":{"type":"object","properties":{"number":{"type":"string","example":"550"},"direction":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"outbound"}},"required":["id","type"]},"id":{"type":"string","example":"550T"}},"required":["number","direction","id"]},"vehicle":{"type":"object","properties":{"sideNumber":{"type":"string","example":"1201"},"type":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"tram"}},"required":["id","type"]},"flags":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","example":"E"},"feature":{"type":"string","example":"electric"}},"required":["id","feature"]}}},"required":["sideNumber","type","flags"]}},"required":["id","estimatedDeparture","trackingStatus","destination","route","vehicle"]}}},"required":["stopIdSip","currentTime","departures"]}}}},"400":{"description":"Invalid parameters"},"500":{"description":"Internal server error"}}}},"/calendar":{"get":{"tags":["Calendar","Runtime"],"summary":"Get all calendar entries","description":"Returns all calendar entries with their day types.","responses":{"200":{"description":"Full calendar","content":{"application/json":{"schema":{"type":"object","properties":{"types":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","example":"PN"},"description":{"type":"string","example":"Dzień powszedni"},"displayOrder":{"type":"number","example":1}},"required":["type","description","displayOrder"]}},"entries":{"type":"array","items":{"type":"object","properties":{"dayType":{"type":"string","example":"PN"},"date":{"type":"string","format":"date","example":"2025-10-16"}},"required":["dayType","date"]}}},"required":["types","entries"]}}}},"500":{"description":"Internal server error"}}}},"/calendar/check":{"get":{"tags":["Calendar","Runtime"],"summary":"Check calendar for a given date","parameters":[{"schema":{"type":"string","format":"date","example":"2025-10-16","description":"Date in YYYY-MM-DD format"},"required":true,"description":"Date in YYYY-MM-DD format","name":"date","in":"query"}],"responses":{"200":{"description":"Calendar entry for the given date","content":{"application/json":{"schema":{"type":"object","properties":{"dayType":{"type":"string","example":"PN"},"date":{"type":"string","format":"date","example":"2025-10-16"}},"required":["dayType","date"]}}}},"404":{"description":"No entry found for the given date"},"500":{"description":"Internal server error"}}}},"/calendar/today":{"get":{"tags":["Calendar","Runtime"],"summary":"Get today's calendar entry","responses":{"200":{"description":"Calendar entry for today","content":{"application/json":{"schema":{"type":"object","properties":{"dayType":{"type":"string","example":"PN"},"date":{"type":"string","format":"date","example":"2025-10-16"}},"required":["dayType","date"]}}}},"404":{"description":"No entry for today"},"500":{"description":"Internal server error"}}}},"/config":{"get":{"tags":["Config","Runtime"],"summary":"Get config of a database of loaded city","description":"Returns config of a database of loaded city","responses":{"200":{"description":"Database config","content":{"application/json":{"schema":{"type":"object","properties":{"TripPlannerEnabled":{"type":"boolean"},"TripPlannerVersion":{"type":"string","example":"2"},"StreetsEnabled":{"type":"boolean"},"VehicleNotesEnabled":{"type":"boolean"},"VehicleSideNumberEnabled":{"type":"boolean"},"VehicleVarianceEnabled":{"type":"boolean"},"_others":{"type":"object","additionalProperties":{"type":"string"}}},"required":["TripPlannerEnabled","TripPlannerVersion","StreetsEnabled","VehicleNotesEnabled","VehicleSideNumberEnabled","VehicleVarianceEnabled","_others"]}}}},"500":{"description":"Internal server error"}}}},"/departure":{"get":{"tags":["Departures","Runtime"],"summary":"Get departures for each dayType-routeNumber-routeVariant combination","responses":{"200":{"description":"Departures for each dayType-routeNumber-routeVariant combination","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"destinationId":{"type":"number","example":428054},"dayType":{"type":"string","example":"PN"},"route":{"type":"object","properties":{"number":{"type":"string","example":"13"},"variant":{"type":"string","example":"D"}},"required":["number","variant"]},"stopIdSip":{"type":"number","example":1},"stopNumberOnRoute":{"type":"number","example":18},"departureTimes":{"type":"array","items":{"type":"object","properties":{"seconds":{"type":"number","example":19500},"hour":{"type":"number","example":5},"minute":{"type":"number","example":25},"label":{"type":"string","example":"05:25"}},"required":["seconds","hour","minute","label"]}}},"required":["destinationId","dayType","route","stopIdSip","stopNumberOnRoute","departureTimes"]}}}}},"500":{"description":"Internal server error"}}}},"/route":{"get":{"tags":["Routes","Runtime"],"summary":"Get routes for each routeNumber-routeVariant combination","responses":{"200":{"description":"Route for each routeNumber-routeVariant combination","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":428061},"number":{"type":"string","example":"160"},"transportMode":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"tram"}},"required":["id","type"]},"direction":{"type":"string","example":"OS.PORĘBA"},"stops":{"type":"array","items":{"type":"number"},"example":[909,899,1280,73,71,68,95,93,91,101,99,97,12,151,244,249,322,1002,327,329,332,353,355,357,363,385,383,396,417,529,531,515,517,568,569]},"variant":{"type":"string","example":"B"},"night":{"type":"boolean","example":false},"depot":{"type":"boolean","example":false},"routeKey":{"type":"string","pattern":"^[^-\\s]+-[a-zA-Z0-9]+$","example":"160-B"},"routeDirection":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"outbound"}},"required":["id","type"]},"routeCode":{"type":"number","example":160},"_defaultVariant":{"nullable":true},"_description":{"nullable":true},"_descriptionNumber":{"nullable":true}},"required":["id","number","transportMode","direction","stops","variant","night","depot","routeKey","routeDirection","routeCode"]}}}}},"500":{"description":"Internal server error"}}}},"/metadata":{"get":{"tags":["Metadata","Runtime"],"summary":"Get server and schedule metadata","responses":{"200":{"description":"Server and schedule metadata","content":{"application/json":{"schema":{"type":"object","properties":{"cityId":{"type":"string","example":"lublin"},"scheduleMetadata":{"type":"object","properties":{"validFrom":{"type":"string","example":"2025-10-01"},"version":{"type":"number","example":4565},"generation":{"type":"number","example":1}},"required":["validFrom","version","generation"]},"lastEditDate":{"type":"string","format":"date-time","example":"2025-10-16T17:06:15.456+02:00[Europe/Warsaw]"},"checksum":{"type":"object","properties":{"patches":{"type":"string","example":"201fe35eb93b77c92830669a0f5344d71c8bbfbfccfa503a1900e212c52ac8ab"},"db":{"type":"string","example":"6893e8c7a8e05760d0e0e800a8bc0b9f88995c3c15f8f6f52cdffb429b09c5be"}},"required":["patches","db"]}},"required":["cityId","scheduleMetadata","lastEditDate","checksum"]}}}},"500":{"description":"Internal server error"}}}},"/notice":{"get":{"tags":["Notice","Runtime"],"summary":"Get notices for each routeNumber","responses":{"200":{"description":"Notices for each routeNumber","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"routeNumber":{"type":"array","items":{"type":"string"}},"name":{"type":"string"},"content":{"type":"string"}},"required":["routeNumber","name","content"]}}}}},"500":{"description":"Internal server error"}}}},"/sales-point":{"get":{"tags":["Sales Point","Runtime"],"summary":"Get sales points","responses":{"200":{"description":"Sales points","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":3},"name":{"type":"string","example":"DWORZEC LUBLIN"},"type":{"type":"object","properties":{"id":{"type":"number","example":1},"description":{"type":"string","enum":["ztm","lubika","kiosk","external","_unknown"],"example":"ztm"}},"required":["id","description"]},"position":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]}},"required":["id","name","type","position"]}}}}},"500":{"description":"Internal server error"}}}},"/street":{"get":{"tags":["Street","Runtime"],"summary":"Get streets","responses":{"200":{"description":"Streets","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number","example":1},"name":{"type":"string","example":"Lipowa"}},"required":["id","name"]}}}}},"500":{"description":"Internal server error"}}}},"/stop":{"get":{"tags":["Stop","Runtime"],"summary":"Get stops info","responses":{"200":{"description":"Stops info","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"idSip":{"type":"number","example":1},"idZtm":{"type":"number","example":1001},"streetId":{"type":"number","example":1},"streetName":{"type":"string","example":"Lipowa"},"order":{"type":"number","example":736},"description":{"type":"string","example":"OGRÓD SASKI 01"},"groupName":{"type":"string","example":"OGRÓD SASKI"},"groupNumber":{"type":"string","example":"01"},"position":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]},"routes":{"type":"object","properties":{"bus":{"type":"array","items":{"type":"string"},"example":["4","8","13","15","20","32","40","44","74","302","950","N2","N3"]},"tram":{"type":"array","items":{"type":"string"},"example":[]},"trolleybus":{"type":"array","items":{"type":"string"},"example":["151","155","158"]}},"required":["bus","tram","trolleybus"]},"destinations":{"type":"array","items":{"type":"string"},"example":["OS.PORĘBA","ŻEGLARSKA","DĄBROWA","ABRAMOWICE","PANCERNIAKÓW","FELIN","HERBERTA","OS.WIDOK","LIPNIAK","DWORZEC LUBLIN","ZEMBORZYCE GÓRNE","KRĘŻNICA JARA","DWORZEC ŚWIDNIK MIASTO","RONDO PRZEMYSŁOWCÓW"]},"transportMode":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"tram"}},"required":["id","type"]},"_post":{"nullable":true},"_tabType":{"nullable":true}},"required":["idSip","idZtm","streetId","streetName","order","description","groupName","groupNumber","position","routes","destinations","transportMode"]}}}}},"500":{"description":"Internal server error"}}}},"/stop/:id":{"get":{"tags":["Stop","Runtime"],"summary":"Get stops info by SIP ID","parameters":[{"schema":{"type":"string","example":"1024","description":"Stop SIP ID"},"required":true,"description":"Stop SIP ID","name":"id","in":"path"}],"responses":{"200":{"description":"Stops info by SIP ID","content":{"application/json":{"schema":{"type":"object","properties":{"idSip":{"type":"number","example":1},"idZtm":{"type":"number","example":1001},"streetId":{"type":"number","example":1},"streetName":{"type":"string","example":"Lipowa"},"order":{"type":"number","example":736},"description":{"type":"string","example":"OGRÓD SASKI 01"},"groupName":{"type":"string","example":"OGRÓD SASKI"},"groupNumber":{"type":"string","example":"01"},"position":{"type":"object","properties":{"longitude":{"type":"number","example":24.945831},"latitude":{"type":"number","example":60.192059}},"required":["longitude","latitude"]},"routes":{"type":"object","properties":{"bus":{"type":"array","items":{"type":"string"},"example":["4","8","13","15","20","32","40","44","74","302","950","N2","N3"]},"tram":{"type":"array","items":{"type":"string"},"example":[]},"trolleybus":{"type":"array","items":{"type":"string"},"example":["151","155","158"]}},"required":["bus","tram","trolleybus"]},"destinations":{"type":"array","items":{"type":"string"},"example":["OS.PORĘBA","ŻEGLARSKA","DĄBROWA","ABRAMOWICE","PANCERNIAKÓW","FELIN","HERBERTA","OS.WIDOK","LIPNIAK","DWORZEC LUBLIN","ZEMBORZYCE GÓRNE","KRĘŻNICA JARA","DWORZEC ŚWIDNIK MIASTO","RONDO PRZEMYSŁOWCÓW"]},"transportMode":{"type":"object","properties":{"id":{"type":"string","example":"T"},"type":{"type":"string","example":"tram"}},"required":["id","type"]},"_post":{"nullable":true},"_tabType":{"nullable":true}},"required":["idSip","idZtm","streetId","streetName","order","description","groupName","groupNumber","position","routes","destinations","transportMode"]}}}},"400":{"description":"Invalid parameters"},"404":{"description":"No stop found for the given id"},"500":{"description":"Internal server error"}}}}}}